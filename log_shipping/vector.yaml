sources:
  docker_logs:
    type: "docker_logs"
    include_containers:
      - "source-json-service"
      - "source-apache-access"
      - "source-apache-error"
      - "source-rfc3164-syslog"
  internal_metrics:
    type: "internal_metrics"
transforms:
  parse_logs:
    inputs:
      - "docker_logs"
    type: "remap"
    source: |
      .timestamp = now()

sinks:
  kafka_logs:
    inputs:
      - "parse_logs"
    type: "kafka"
    bootstrap_servers: "kafka:9092"
    topic: "logs"
    encoding:
      codec: "json"
    batch:
      max_bytes: 104857600 
      max_events: 500000 
    buffer:
      type: "memory" 
      max_size: 100000
      when_full: "block" 
    healthcheck:
      enabled: true
  prometheus:
    type: "prometheus_exporter"
    inputs:
      - "internal_metrics"
    address: "0.0.0.0:8686"
